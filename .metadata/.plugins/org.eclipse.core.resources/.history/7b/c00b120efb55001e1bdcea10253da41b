package com.ryu.app;

import java.util.List;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.jdbc.core.BeanPropertyRowMapper;
import org.springframework.jdbc.core.JdbcTemplate;
import org.springframework.stereotype.Repository;

@Repository
public class BoardDAO {

   @Autowired
   private JdbcTemplate jdbcTemplate; //의존관계(멤버변수)

   //응집도를 높여줌
   private final String SELECTALL = "SELECT (BID,MID,CONTENT) FROM BOARD";
   private final String SELECTONE = "SELECT (BID) FROM BOARD WHERE BID=?";
   private final String INSERT = "INSERT INTO BOARD (BID,MID,CONTENT) VALUES ((SELECT NVL(MAX(BID),9999)+1 FROM BOARD), ? , ? )";
   private final String UPDATE = "UPDATE BOARD SET CONTENT=? WHERE BID=?";
   private final String DELETE = "DELETE BOARD MEMBER WHERE BID=?";

   public List<BoardDTO> selectAll(BoardDTO bDTO){
      return jdbcTemplate.query(SELECTALL, new BeanPropertyRowMapper<BoardDTO>(BoardDTO.class));
   }

   public BoardDTO selectOne(BoardDTO bDTO) {

      Object[] args = { bDTO.getBid()};
      return jdbcTemplate.queryForObject(SELECTONE, args, new BeanPropertyRowMapper<BoardDTO>(BoardDTO.class));
   }
   public boolean insert(BoardDTO bDTO) {

      int result = jdbcTemplate.update(INSERT, bDTO.getMid(), bDTO.getContent());

      if (result > 0) {
         return true;
      }
      return false;
   }

   public boolean update(BoardDTO bDTO) {

      int result = jdbcTemplate.update(UPDATE, bDTO.getContent(), bDTO.getMid());

      if (result > 0) {
         return true;
      }
      return false;
   }

   public boolean delete(BoardDTO bDTO) {

      int result = jdbcTemplate.update(DELETE, bDTO.getMid(), bDTO.getContent());

      if (result > 0) {
         return true;
      }
      return false;
   }
}