package com.ryu.app;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.RequestMapping;


import jakarta.servlet.http.HttpSession;

@Controller
public class CTRL {

   @Autowired
   MemberDAO mDAO;
   @Autowired
   BoardDAO bDAO;

   @RequestMapping("/")
   public String root() {
      return "redirect:main";
   }

   @RequestMapping("/login")
   public String login(MemberDTO mDTO, HttpSession session) {
      mDTO = mDAO.selectOne(mDTO);
      if (mDTO != null) {
         session.setAttribute("mid", mDTO.getMid());
      }
      return "redirect:main";
   }

   @RequestMapping("/singup")
   public String signup(MemberDTO mDTO) {
      boolean flag = mDAO.insert(mDTO);
      if (flag) {
         System.out.println("회원가입 성공");
      } else {
         System.out.println("실패");
      }
      return "redirect:main";
   }
   
   @RequestMapping("/mypage")
   public String join(MemberDTO mDTO, HttpSession session, Model model) {
	   mDTO.setMid((String)session.getAttribute("mid"));
	   mDTO=mDAO.selectOne(mDTO);
	   
	   model.addAttribute("mdata", mDTO);
	   
	   return "mypage";
   }
   
   @RequestMapping("/updateMpw")
   public String updateMpw(MemberDTO mDTO) {
	   
	   mDAO.update(mDTO);
	   
	   
	   return "mypage";
   }
   
   @RequestMapping("/deleteMember")
   public String deleteMpw(MemberDTO mDTO, HttpSession session) {
	   
	   mDAO.delete(mDTO);
	   
	   session.removeAttribute("mid");
	   return "redirect: main";
   }

   @RequestMapping("/logout")
   public String logout(HttpSession session) {
	   session.removeAttribute("mid");
	   return "redirect:main";
   }

   @RequestMapping("/main")
   public String main(MemberDTO mDTO, HttpSession session) {
	   List<BoardDTO>=bDAO.selectAll(null)
	   
	   
	   return "main";
   }
   
   
   
   
   
}